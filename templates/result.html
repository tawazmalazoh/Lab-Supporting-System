{% extends "base.html" %} 
{% load static %} 
{% load crispy_forms_tags %} 
{% block content %}






  <!--  -- E Charts-->
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.2.1/dist/echarts.min.js"></script>


 

<!-- start Data Table libraries  -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/jquery.dataTables.min.css"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.datatables.net/v/bs4-4.6.0/jq-3.7.0/jszip-3.10.1/dt-1.13.5/af-2.6.0/b-2.4.1/b-colvis-2.4.1/b-html5-2.4.1/b-print-2.4.1/cr-1.7.0/date-1.5.1/fc-4.3.0/fh-3.4.0/kt-2.10.0/r-2.5.0/rg-1.4.0/rr-1.4.1/sc-2.2.0/sb-1.5.0/sp-2.2.0/sl-1.7.0/sr-1.3.0/datatables.min.css" rel="stylesheet">
 <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/v/bs4-4.6.0/jq-3.7.0/jszip-3.10.1/dt-1.13.5/af-2.6.0/b-2.4.1/b-colvis-2.4.1/b-html5-2.4.1/b-print-2.4.1/cr-1.7.0/date-1.5.1/fc-4.3.0/fh-3.4.0/kt-2.10.0/r-2.5.0/rg-1.4.0/rr-1.4.1/sc-2.2.0/sb-1.5.0/sp-2.2.0/sl-1.7.0/sr-1.3.0/datatables.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.min.js"></script>
<!-- end Datatable -->
 
<script>
  var jQuery_3_6_0 = $.noConflict(true);
  </script>
  

<!-- these are libraries for MULTIPLE SELECT -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
<!-- end of libraries for multiple select -->
<script>
  var jQuery_2_1_1 = $.noConflict(true);
  </script>


<script src=" {% static 'assets/js/echarts.min.js'%}"></script>




  
    <!--------start-->
    <section class="section">

      <!---------------filters------------->
    
    <div class="alert alert-success" role="alert">
      <h4 class="alert-heading">Apply Filters</h4>
     
      <p class="mb-0">Select the filters to display the charts.</p>
      <hr />
      <!-- General Form Elements -->
      {% load crispy_forms_tags %}
      <form method="post" id="ist-form">
        {% csrf_token %}
        <div class="row justify-content-start">
          
          <div class="col-3">
            <label for="inputDate" style="font-weight: bold; font-family: Arial, sans-serif;">Start Date</label>
         
              <input type="date" id="startdate" name="startdate" class="form-control" required>
            </div>

            <div class="col-4">
              <label for="inputselectMultiple" style="font-weight: bold; font-family: Arial, sans-serif;">Filter by Province</label><br>
              <select class="selectpicker" multiple name="province" style="width: 100%;" required>
                <option>Mashonaland East</option>
                <option>Mashonaland West</option>
                <option>Masvingo</option>
                <option>Matebeleland North</option>
                <option>Matebeleland South</option>
                <option>Mashonaland Central</option>
                <option>Midlands</option>
                <option>Harare</option>
                <option>Manicaland</option>                
                <option>Bulawayo</option>
                <option>Mashonaland East</option>
              </select>         
              </div>

              <div class="col-4">
                <label for="inputselectSupport" style="font-weight: bold; font-family: Arial, sans-serif;">Filter by Support</label><br>
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" id="dsdCheckbox" name="dsdCheckbox"  checked >
                  <label class="form-check-label" for="flexSwitchCheckDefault"> DSD</label>
                </div>
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" id="taSdiCheckbox" name="taSdiCheckbox"  checked>
                  <label class="form-check-label" for="flexSwitchCheckChecked"> TA-SDI</label>
                </div>
                
                </div>



          </div> 


          <div class="row justify-content-start">
          
            <div class="col-3">
              <label for="endDate" style="font-weight: bold; font-family: Arial, sans-serif;">End Date</label>        
                <input type="date" id="enddate" name="enddate" class="form-control" required>
              </div>
  
              <div class="col-4">
                <br>
                <button id="submitfilter" name="submitfilter" class="btn btn-primary">Apply Filter</button>
                </div>
            </div>     

      </form>
    </div>
    
        <!----------------end filters------------------>
 
<!-- displaying the message alert -->
<div id="response-msg-container"></div>
{% for message in messages %}
<div class="alert {{ message.tags }} alert-dismissible fade show" role="alert">
<i class="bi bi-exclamation-octagon me-1"></i>
{{ message|safe }} <br>      
<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
{% endfor %}    
 
   



      <div class="row"><!--start row-->
        <div class="col-lg-1">
          <div class="card-body">
          </div>
          </div>
      
        <!----section 1-->
        <div class="col-lg-2">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Plasma Results</h5>
              {% for result in data %}
                  {% if result.query_name == 'OveralSampleTotals' %}
                      {% for row in result.query_data %}
                             {{ row.vl_plasma_res }}
                      {% endfor %}
                  {% endif %}
              {% endfor %}
      
            </div>
          </div>
        </div><!--end section-->
      
          <!----section 2-->
          <div class="col-lg-2">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">VL DBS Results</h5>
                {% for result in data %}
                  {% if result.query_name == 'OveralSampleTotals' %}
                      {% for row in result.query_data %}
                             {{ row.vl_dbs_res }}
                      {% endfor %}
                  {% endif %}
              {% endfor %}
              </div>
            </div>
          </div><!--end section-->
      
            <!----section 3-->
        <div class="col-lg-2">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">EID Results</h5>
              {% for result in data %}
                {% if result.query_name == 'OveralSampleTotals' %}
                    {% for row in result.query_data %}
                           {{ row.eid_res }}
                    {% endfor %}
                {% endif %}
            {% endfor %}
      
            </div>
          </div>
        </div><!--end section-->
      
          <!----section 4-->
          <div class="col-lg-2">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">TB Results</h5>
                {% for result in data %}
                  {% if result.query_name == 'OveralSampleTotals' %}
                      {% for row in result.query_data %}
                             {{ row.sputum_res }}
                      {% endfor %}
                  {% endif %}
              {% endfor %}
        
              </div>
            </div>
          </div><!--end section-->
      
          <!----section 5-->
          <div class="col-lg-2">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">Other Results</h5>
                {% for result in data %}
                  {% if result.query_name == 'OveralSampleTotals' %}
                      {% for row in result.query_data %}
                             {{ row.OtherRes }} 
                      {% endfor %}
                  {% endif %}
              {% endfor %}
        
              </div>
            </div>
          </div><!--end section-->
      
          <div class="col-lg-1">
          <div class="card-body">
          </div>
          </div>
      
      </div><!--end row-->






      <div class="row">

        <div class="col-lg-12">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Specimens Results by District </h5>
    
              <!-- Bar Chart --->
    
              <div id="eidvltransres" style="width: 100%; height: 400px"></div>
             
              <!-- End Bar CHart -->
            </div>
          </div>
        </div>

        <div class="alert alert-info alert-dismissible fade show" role="alert">
          Trend for TB !

        </div>

    
        <div class="col-lg-12">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">TB Specimens AND Results Transported trend              
              </h5>
              <div id="TBSpecimensTrend" style="width: 100%; height: 400px"></div>
          
    
            </div>
          </div>
        </div>
    
        <div class="alert alert-info alert-dismissible fade show" role="alert">
          Trend for Other Specimens !

        </div>

    
        <div class="col-lg-12">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Other Specimens AND Results Transported trend              
              </h5>
              <div id="OtherSpecimensTrend" style="width: 100%; height: 400px"></div>
          
    
            </div>
          </div>
        </div>



       <div class="col-lg-9">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">--</h5>
              <!--  Proportion of facilites visited Chart -->
    
               <div id="distpercentages" style="width: 100%; height: 500px"></div>
                 
 
           <!-- End  CHart -->
            </div>
          </div>
        </div>
    
 
    
    
        <div class="alert alert-success alert-dismissible fade show" role="alert">
          <i class="bi bi-star me-1"></i>
          TA-SDI!    
        </div>
    
    
      
        <div id="ta_sdibar" style="width: 100%; height: 400px"></div>
    
    
      <!-------------------------starst------------------------->
      
      <div class="col-lg-9">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">--</h5>
            <!--  Proportion of facilites visited Chart -->
    
             <div id="TA_SDIdistpercentages" style="width: 100%; height: 500px"></div>
            
    
         <!-- End  CHart -->
          </div>
        </div>
      </div>


   <!---------------------->
    
    
    
    <div class="alert alert-secondary alert-dismissible fade show" role="alert">
      <i class="bi bi-collection me-1"></i>
     IST Samples Total transported by Month !    
    </div>
    
    
    
    
    
    
    
    
    
    
    
    
        <div class="col-lg-12">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">DSD vs TA-SDI Samples Transported Monthly Trend</h5>
              <div id="trends_of_SampleTransported" style="width: 100%; height: 500px"></div>

               </div>
          </div>
        </div>
    
    
    
    
    
    
      </div>
    </section>

    <!---------end------------->
   
  </div>














 


    






    
  

<!-- End Default Tabs -->
















<script
  src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.2/echarts.min.js"
  integrity="sha512-VdqgeoWrVJcsDXFlQEKqE5MyhaIgB9yXUVaiUa8DR2J4Lr1uWcFm+ZH/YnzV5WqgKf4GPyHQ64vVLgzqGIchyw=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
></script>

<script>
jQuery(document).ready(function () {
    jQuery("#aggregationtbl").DataTable({
        dom: 'Bfrtip',
        buttons: [
            'copy', 'csv', 'excel', 'pdf', 'print'
        ]
    });
});
</script>




<script>
  $(document).ready(function(){
    $('select').selectpicker();
  });
  </script>


<script>
  $(document).ready(function () {
    $("#myTable").DataTable({

      responsive: {
        details: true
    },

      dom: "Bfrtip",
      buttons: ["copy", "csv", "excel", "pdf", "print"],
    });
  });
</script>


<script>
  var app = {};
  
  var chartDom = document.getElementById('eidvltransres');

  var myChart = echarts.init(chartDom);
  var option;
  
  var OveralDistricts = [ 
                      {% for result in data %}
                                {% if result.query_name == 'DistrictISTResults' %}
                                    {% for row in result.query_data %}
                                    '{{ row.District_ }}',
                                    {% endfor %}
                                {% endif %}
                            {% endfor %}

                          ];
  
  var seriesSpecimenDict = {};
                {% for result in data %}
                   {% if result.query_name == 'DistrictISTResults' %}
                      {% for row in result.query_data %}
                      seriesSpecimenDict['{{ row.District_ }}'] = '{{ row.Overal_Transported }}';
                      {% endfor %}
                   {% endif %}
                {% endfor %}

  
  var seriesSpecimen =OveralDistricts.map(function(over) {
              return seriesSpecimenDict[over];
          });
  
  
  
  
  var seriesResultsDict = {};
                  {% for result in data %}
                    {% if result.query_name == 'DistrictISTResults' %}
                        {% for row in result.query_data %}
                        seriesResultsDict['{{ row.District_ }}'] = '{{ row.Overal_results }}';
                        {% endfor %}
                    {% endif %}
                  {% endfor %}

  
  var seriesResults =OveralDistricts.map(function(over) {
              return seriesResultsDict[over];
          });


  
  
  
  const posList = [
    'left',
    'right',
    'top',
    'bottom',
    'inside',
    'insideTop',
    'insideLeft',
    'insideRight',
    'insideBottom',
    'insideTopLeft',
    'insideTopRight',
    'insideBottomLeft',
    'insideBottomRight'
  ];
  app.configParameters = {
    rotate: {
      min: -90,
      max: 90
    },
    align: {
      options: {
        left: 'left',
        center: 'center',
        right: 'right'
      }
    },
    verticalAlign: {
      options: {
        top: 'top',
        middle: 'middle',
        bottom: 'bottom'
      }
    },
    position: {
      options: posList.reduce(function (map, pos) {
        map[pos] = pos;
        return map;
      }, {})
    },
    distance: {
      min: 0,
      max: 100
    }
  };
  app.config = {
    rotate: 90,
    align: 'left',
    verticalAlign: 'middle',
    position: 'top',
    distance: 6,
    onChange: function () {
      const labelOption = {
        rotate: app.config.rotate,
        align: app.config.align,
        verticalAlign: app.config.verticalAlign,
        position: app.config.position,
        distance: app.config.distance
      };
      myChart.setOption({
        series: [
          {
            label: labelOption
          },
          {
            label: labelOption
          },
          {
            label: labelOption
          },
          {
            label: labelOption
          }
        ]
      });
    }
  };
  const labelOption = {
    show: true,
    position: app.config.position,
    distance: app.config.distance,
    align: app.config.align,
    verticalAlign: app.config.verticalAlign,
    rotate: app.config.rotate,
    formatter: '{c}  {name|{a}}',
    fontSize: 16,
    rich: {
      name: {}
    }
  };
  option = {
    tooltip: {
      trigger: 'axis',
      axisPointer: {
        type: 'shadow'
      }
    },
    legend: {
      data: ['Specimens', 'Results']
    },
    toolbox: {
      show: true,
      orient: 'vertical',
      left: 'right',
      top: 'center',
      feature: {
        mark: { show: true },
        dataView: { show: true, readOnly: false },
        magicType: { show: true, type: ['line', 'bar', 'stack'] },
        restore: { show: true },
        saveAsImage: { show: true }
      }
    },
    xAxis: [
      {
        type: 'category',
        axisLabel: {
                                  rotate: 90
                                },
        axisTick: { show: false },
        data: OveralDistricts
      }
    ],
    yAxis: [
      {
        type: 'value'
      }
    ],
    series: [
      {
        name: 'Specimens',
        type: 'bar',
        barGap: 0,
        label: labelOption,
        emphasis: {
          focus: 'series'
        },
        data: seriesSpecimen
      },
      {
        name: 'Results',
        type: 'bar',
        label: labelOption,
        emphasis: {
          focus: 'series'
        },
        data: seriesResults
      }
    ]
  };
  
  option && myChart.setOption(option);
  </script>
  
<!------------Next Graph---------------->
<script>
  var chartDom = document.getElementById('TBSpecimensTrend');
  var myChart = echarts.init(chartDom);
  var option;
  
  var TrendDates = [ 
                      {% for result in data %}
                                {% if result.query_name == 'TrendSpecimenResults' %}
                                    {% for row in result.query_data %}
                                    '{{ row.month }}',
                                    {% endfor %}
                                {% endif %}
                            {% endfor %}

                          ];
  
  var seriesTBSpecimenDict = {};
                {% for result in data %}
                   {% if result.query_name == 'TrendSpecimenResults' %}
                      {% for row in result.query_data %}
                      seriesTBSpecimenDict['{{ row.month }}'] = '{{ row.sputum_sam }}';
                      {% endfor %}
                   {% endif %}
                {% endfor %}

  
  var seriesTBSpecimen =TrendDates.map(function(overu) {
              return seriesTBSpecimenDict[overu];
          });
  
  
  
  
  var seriesTBResultsDict = {};
                  {% for result in data %}
                    {% if result.query_name == 'TrendSpecimenResults' %}
                        {% for row in result.query_data %}
                        seriesTBResultsDict['{{ row.month }}'] = '{{ row.sputum_res }}';
                        {% endfor %}
                    {% endif %}
                  {% endfor %}

  
  var seriesTBResults =TrendDates.map(function(overi) {
              return seriesTBResultsDict[overi];
          });



  //               seriesTBResults = seriesTBResults.map(value => !isNaN(value) ? Number(value) : NaN);
  //               seriesTBSpecimen= seriesTBResults.map(value => !isNaN(value) ? Number(value) : NaN);

  //               let maxTBResIndex = 0;
  //               let minTBResIndex = 0;
  //               let maxTBRes = seriesTBResults[0];
  //               let minTBRes = seriesTBResults[0];

                
  //               for (let i = 1; i < seriesTBResults.length; i++) {
  //                 if (seriesTBResults[i] > maxTBRes) {
  //                   maxTBRes = seriesTBResults[i];
  //                   maxTBResIndex = i;
  //                 }
                
  //                 if (seriesTBResults[i] < minTBRes) {
  //                   minTBRes = seriesTBResults[i];
  //                   minTBResIndex = i;
  //                 }
  //               }

                
  //               let maxTBSpecIndex = 0;
  //               let minTBSpecIndex = 0;
  //               let maxTBSpec = seriesTBSpecimen[0];
  //               let minTBSpec = seriesTBSpecimen[0];

  //               for (let i = 1; i < seriesTBSpecimen.length; i++) {
  //                 if (seriesTBSpecimen[i] > maxTBSpec) {
  //                   maxTBSpec = seriesTBSpecimen[i];
  //                   maxTBSpecIndex = i;
  //                 }
                
  //                 if (seriesTBSpecimen[i] < minTBSpec) {
  //                   minTBSpec = seriesTBSpecimen[i];
  //                   minTBSpecIndex = i;
  //                 }
  //               }

  //               console.log(maxTBSpec)  
  //               console.log(minTBSpec)  

  //               console.log(maxTBRes)  
  //               console.log(minTBRes)      



  option = {
    tooltip: {
      trigger: 'axis'
    },
    legend: {},
    toolbox: {
      show: true,
      feature: {
        dataZoom: {
          yAxisIndex: 'none'
        },
        dataView: { readOnly: false },
        restore: {},
        saveAsImage: {}
      }
    },
    //----------ZOOMING------------------------->
    dataZoom: [
                            {
                              show: true,
                              realtime: true,
                              start: 5,
                              end: 90,
                              xAxisIndex: [0, 1]
                            },
                            {
                              type: 'inside',
                              realtime: true,
                              start: 5,
                              end: 90,
                              xAxisIndex: [0, 1]
                            }
                          ],
                          grid: [
                            {
                              left: 60,
                              right: 50,
                              height: '35%'
                            },
                            {
                              left: 60,
                              right: 50,
                              top: '55%',
                              height: '35%'
                            }
                          ],
    //-------------------------------------------------------------->
    xAxis: {
      type: 'category',
      boundaryGap: false,
      data: TrendDates
    },
    yAxis: {
      type: 'value',
      axisLabel: {
        formatter: '{value} '
      }
    },
    series: [
      {
        name: 'TB Specimens',
        type: 'line',
        data: seriesTBSpecimen,
        markPoint: {
          data: [
            { type: 'max', name: 'Max' },
            { type: 'min', name: 'Min' }
          ]
        },
        markLine: {
          data: [{ type: 'average', name: 'Avg' }]
        }
      },
      {
        name: 'TB Results',
        type: 'line',
        data: seriesTBResults,
        markPoint: {
          data: [{ name: '周最低', value: -2, xAxis: 1, yAxis: -1.5 }]
        },
        markLine: {
          data: [
            { type: 'average', name: 'Avg' },
            [
              {
                symbol: 'none',
                x: '90%',
                yAxis: 'max'
              },
              {
                symbol: 'circle',
                label: {
                  position: 'start',
                  formatter: 'Max'
                },
                type: 'max',
                name: '最高点'
              }
            ]
          ]
        }
      }
    ]
  };

  option && myChart.setOption(option);
    </script>


<!-------------------------other -->
<script>
  var chartDom = document.getElementById('OtherSpecimensTrend');
  var myChart = echarts.init(chartDom);
  var option;
  
  var OtherTrendDates = [ 
                      {% for result in data %}
                                {% if result.query_name == 'TrendSpecimenResults' %}
                                    {% for row in result.query_data %}
                                    '{{ row.month }}',
                                    {% endfor %}
                                {% endif %}
                            {% endfor %}

                          ];
  
  var seriesOtherSpecimenDict = {};
                {% for result in data %}
                   {% if result.query_name == 'TrendSpecimenResults' %}
                      {% for row in result.query_data %}
                      seriesOtherSpecimenDict['{{ row.month }}'] = '{{ row.OtherSam }}';
                      {% endfor %}
                   {% endif %}
                {% endfor %}

  
  var seriesOtherSpecimen =OtherTrendDates.map(function(overu) {
              return seriesOtherSpecimenDict[overu];
          });
  
  
  
  
  var seriesOtherResultsDict = {};
                  {% for result in data %}
                    {% if result.query_name == 'TrendSpecimenResults' %}
                        {% for row in result.query_data %}
                        seriesOtherResultsDict['{{ row.month }}'] = '{{ row.OtherRes }}';
                        {% endfor %}
                    {% endif %}
                  {% endfor %}

  
  var seriesOtherResults =OtherTrendDates.map(function(overi) {
              return seriesOtherResultsDict[overi];
          });

          console.log(seriesOtherResults);
  console.log(seriesOtherSpecimen);
  console.log(OtherTrendDates);


  //               seriesTBResults = seriesTBResults.map(value => !isNaN(value) ? Number(value) : NaN);
  //               seriesTBSpecimen= seriesTBResults.map(value => !isNaN(value) ? Number(value) : NaN);

  //               let maxTBResIndex = 0;
  //               let minTBResIndex = 0;
  //               let maxTBRes = seriesTBResults[0];
  //               let minTBRes = seriesTBResults[0];

                
  //               for (let i = 1; i < seriesTBResults.length; i++) {
  //                 if (seriesTBResults[i] > maxTBRes) {
  //                   maxTBRes = seriesTBResults[i];
  //                   maxTBResIndex = i;
  //                 }
                
  //                 if (seriesTBResults[i] < minTBRes) {
  //                   minTBRes = seriesTBResults[i];
  //                   minTBResIndex = i;
  //                 }
  //               }

                
  //               let maxTBSpecIndex = 0;
  //               let minTBSpecIndex = 0;
  //               let maxTBSpec = seriesTBSpecimen[0];
  //               let minTBSpec = seriesTBSpecimen[0];

  //               for (let i = 1; i < seriesTBSpecimen.length; i++) {
  //                 if (seriesTBSpecimen[i] > maxTBSpec) {
  //                   maxTBSpec = seriesTBSpecimen[i];
  //                   maxTBSpecIndex = i;
  //                 }
                
  //                 if (seriesTBSpecimen[i] < minTBSpec) {
  //                   minTBSpec = seriesTBSpecimen[i];
  //                   minTBSpecIndex = i;
  //                 }
  //               }

  //               console.log(maxTBSpec)  
  //               console.log(minTBSpec)  

  //               console.log(maxTBRes)  
  //               console.log(minTBRes)      



  option = {
    tooltip: {
      trigger: 'axis'
    },
    legend: {},
    toolbox: {
      show: true,
      feature: {
        dataZoom: {
          yAxisIndex: 'none'
        },
        dataView: { readOnly: false },
        magicType: { type: ['line', 'bar'] },
        restore: {},
        saveAsImage: {}
      }
    },
    xAxis: {
      type: 'category',
      boundaryGap: false,
      data: OtherTrendDates
    },
    yAxis: {
      type: 'value',
      axisLabel: {
        formatter: '{value} '
      }
    },
    series: [
      {
        name: 'Other Specimens',
        type: 'line',
        data: seriesOtherSpecimen,
        markPoint: {
          data: [
            { type: 'max', name: 'Max' },
            { type: 'min', name: 'Min' }
          ]
        },
        markLine: {
          data: [{ type: 'average', name: 'Avg' }]
        }
      },
      {
        name: 'Other Results',
        type: 'line',
        data: seriesOtherResults,
        markPoint: {
          data: [{ name: '周最低', value: -2, xAxis: 1, yAxis: -1.5 }]
        },
        markLine: {
          data: [
            { type: 'average', name: 'Avg' },
            [
              {
                symbol: 'none',
                x: '90%',
                yAxis: 'max'
              },
              {
                symbol: 'circle',
                label: {
                  position: 'start',
                  formatter: 'Max'
                },
                type: 'max',
                name: '最高点'
              }
            ]
          ]
        }
      }
    ]
  };

  option && myChart.setOption(option);
    </script>





<script type="text/javascript">
  $(document).ready(function (e) {
    $('#submitfilter').on('click', function (e) {
      //e.preventDefault();
      var submitButton = $('#submitfilter'); // Get the submit button
      // Get checkbox values
      var dsdChecked = $('#dsdCheckbox').prop('checked');
      var taSdiChecked = $('#taSdiCheckbox').prop('checked');
      var startdate = $('#startdate').val();
      var enddate = $('#enddate').val();
      //var province = $('.selectpicker').val();
      var province = JSON.stringify($('.selectpicker').val());
  
      // Log values to the console
      console.log('Start date: ', startdate);
      console.log('End date: ', enddate);
      console.log('Province: ', province);
      console.log('DSD Checked: ', dsdChecked);
      console.log('TA-SDI Checked: ', taSdiChecked);
  
      $.ajax({
        type: 'POST', 
        url: '{% url 'specimens_results' %}', 
        data: {
          startdate: startdate,
          enddate: enddate,
          province: province,
          dsd: dsdChecked,
          ta_sdi: taSdiChecked,
          csrfmiddlewaretoken: '{{ csrf_token }}', // Include the CSRF token in the data
        },
        success: function (response) { // display success response
         // If the request is successful, handle the response and display the message
         responsd = 'Sucessfully'
         $('#response-msg-container').html('<div class="alert alert-error" role="alert">' + responsd + '</div>');
  //
          // Restore the submit button text after a short delay (1.5 seconds in this case)
          setTimeout(function () {
            submitButton.prop('disabled', false).html('Filters Applied on the charts');
          }, 1500);
        },
        error: function(error) {
          console.log(error);
        }
      });
    });
  });
  </script>
{% endblock content %}
